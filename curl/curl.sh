#!/usr/bin/env bash

set -u

(echo -n "Start curl: " && date --rfc-3339=seconds) >> log

while read URL
do
	FILENAME=`echo ${URL} | sed 's/\:\/\//_/' | sed 's/\//__/g'`
	curl -i -k --write-out \
	'%{response_code}|%{url}|%{remote_ip}|%{size_download}|%{size_header}|%{time_total}\n' \
	-A "Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0" \
	--silent --output curl-${FILENAME}.txt -m 5 ${URL}
done < targets

(echo -n "End curl: " && date --rfc-3339=seconds) >> log
